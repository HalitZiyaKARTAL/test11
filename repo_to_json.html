<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Repo to JSON/txt</title>
<style>
:root{--b:#121212;--s:#1e1e1e;--t:#e0e0e0;--t2:#a0a0a0;--bd:#444;--a:#3b82f6;--ah:#2563eb;--ok:#28a745;--err:#dc3545;--bt:#4a4a4a}*{box-sizing:border-box}html{font-size:clamp(15px,1.5vw + .5rem,18px)}body{font-family:-apple-system,sans-serif;line-height:1.6;color:var(--t);background:var(--b);margin:0;padding:env(safe-area-inset-top,1.5rem) env(safe-area-inset-right,1.5rem) env(safe-area-inset-bottom,1.5rem) env(safe-area-inset-left,1.5rem)}main{background:var(--s);padding:1.5rem;border-radius:.5rem;box-shadow:0 .25rem .75rem #0008;max-width:900px;width:100%;margin:0 auto}h1{text-align:center;color:var(--a);margin:0}label{font-weight:700;margin-top:1.5rem;display:block;color:var(--t2)}.g{display:flex;gap:.5rem;margin-top:.25rem;flex-wrap:wrap}.g input{flex:1}.g select{flex:0;width:auto}input,select,textarea{width:100%;padding:.75rem;border-radius:.5rem;border:1px solid var(--bd);font-size:.9rem;background:#2a2a2a;color:var(--t)}input:focus,select:focus,textarea:focus{outline:2px solid var(--a);outline-offset:-1px}textarea{min-height:15rem;font-family:monospace;resize:vertical}button{display:block;width:100%;padding:.8rem;margin:1.25rem 0 .75rem;font-size:1rem;font-weight:700;color:#fff;background:var(--a);border:none;border-radius:.5rem;cursor:pointer;transition:.2s}button:hover:not(:disabled){background:var(--ah)}button:disabled{background:#555;color:#999;cursor:not-allowed}.b2{background:var(--bt);margin-top:.5rem;font-size:.8rem;padding:.6rem}.b2:hover:not(:disabled){background:#5a5a5a}#st{margin:.75rem 0;padding:.75rem;background:#333;border-radius:.5rem;text-align:center;font-weight:700;color:var(--t2);word-wrap:break-word}#sd{margin-top:1rem;text-align:center;font-size:.9rem;color:var(--t2)}@media(max-width:600px){body{padding:.5rem}main{padding:1rem}}.mt{margin-top:.5rem}.f1{flex:1 1 auto}.c-wr{display:flex;flex:1 1 auto;min-width:max-content}.c-in{field-sizing:content;width:auto;max-width:100%}@supports not (field-sizing:content){.c-in{width:100%}}.arr{margin:0;border-radius:0 .5rem .5rem 0;padding:0 .75rem;width:auto}.l-br{border-radius:.5rem 0 0 .5rem;border-right:none;width:100%}.bar{align-items:center;background:#2a2a2a;border-radius:.5rem;border:1px solid var(--bd);padding:0 .5rem}.bar label{margin:0;font-weight:400;font-size:.9rem;white-space:nowrap}.bar input,.bar select{border:none;background:0 0;padding:.75rem .25rem;flex:1 1 3rem}.bar select{flex:0}.bar .dl{width:1px;height:1.5rem;background:var(--bd);margin:0 .5rem}.cb-l{margin:0;padding:0 .5rem;background:#2a2a2a;border-radius:.5rem;border:1px solid var(--bd);flex:0 0 auto;display:flex;align-items:center;gap:.25rem;cursor:pointer;white-space:nowrap}.cb-l span{font-size:.7em;opacity:.7;font-weight:400}input[type=checkbox]{margin:0;width:auto;cursor:pointer}.ib-w{display:flex;border-radius:.5rem;overflow:hidden;margin-top:.75rem}.ib-w button{margin:0!important;border-radius:0!important;flex:1}.ib-w label{margin:0;display:flex;align-items:center;gap:.35rem;padding:0 .75rem;color:#fff;font-size:.85rem;cursor:pointer}.ib-w:has(button:disabled) label{opacity:.6;pointer-events:none}.ib-i{margin:0;width:5ch;padding:.1rem;background:rgba(0,0,0,.25);border:1px solid rgba(255,255,255,.2);color:#fff;border-radius:.25rem;font-size:.9rem;text-align:center}.wp{position:relative}.tb{position:absolute;top:0;right:0;z-index:9;display:flex;gap:1px;background:var(--bd);border-radius:0 .5rem 0 .5rem;overflow:hidden;border-left:1px solid var(--bd);border-bottom:1px solid var(--bd)}.tb span{cursor:pointer;padding:.3rem .6rem;background:#050505;color:#aaa;font-size:1rem;line-height:1;user-select:none;transition:.2s}.tb span:hover{background:#333;color:#fff}.au{field-sizing:content;height:auto!important}.fs{position:fixed;inset:5%;z-index:999;box-shadow:0 0 0 99in #0009;background:var(--s);display:flex;flex-direction:column}.fs textarea{height:100%!important;resize:none}
</style></head><body><main>
<h1>Repo to JSON/txt</h1><p><strong>Instructions:</strong> Configure parameters or use URL.</p><label>1. Repository Configuration</label>
<div class=g><select id=ps><option value=github selected>GitHub</option><option value=gitlab>GitLab</option></select><input type=text id=un class="c-in f1" placeholder=Username style=min-width:15ch><div class=c-wr><input type=text id=rn list=dl_r class="c-in l-br" placeholder=Repository style=min-width:10ch><button id=btn_r class="b2 arr" title="Fetch Repos">â–¼</button><datalist id=dl_r></datalist></div><div class=c-wr><input type=text id=br list=dl_b class="c-in l-br" placeholder=Branch style=min-width:6ch><button id=btn_b class="b2 arr" title="Fetch Branches">â–¼</button><datalist id=dl_b></datalist></div></div>
<input type=text id=ur value="https://github.com/HalitZiyaKARTAL/test11" placeholder="OR paste full URL here..." class=mt>
<button id=gt>2. Generate JSON File Tree</button><button id=cr class=b2>Check API Rate Limit</button>
<label for=ji>3. JSON Tree</label><textarea id=ji placeholder="Click 'Generate' or paste JSON..."></textarea>
<label>4. Filters & Limits</label>
<div class="g bar"><label for=fd title="-1 means unlimited">Depth (-1=All):</label><input type=number id=fd value=-1><div class=dl></div><label for=sl>Max Size:</label><input type=number id=sl value=1 min=1><select id=su><option value=KB>KB</option><option value=MB>MB</option><option value=GB selected>GB</option></select></div>
<div class="g mt"><input type=text id=fw placeholder="Whitelist (e.g. src/, file.txt)"><input type=text id=fwr placeholder="Regex WL (e.g. \.js$)"><label class=cb-l title="Overrides size and depth limits"><input type=checkbox id=fh> harder <span>(overrides depth/size)</span></label></div>
<div class="g mt"><input type=text id=fb placeholder="Blacklist (e.g. node_modules/, .md)"><input type=text id=fbr placeholder="Regex BL (e.g. .*old\.html$)"><label class=cb-l title="Skip binary detection (use if buggy)"><input type=checkbox id=fn> filter nothing</label></div>
<div class=ib-w><button id=af class=b2>Apply Filters to Tree (Prune)</button><label style=background:#3a3a3a title="Keep folder structures & sizes intact; only remove files."><input type=checkbox id=fo> files only</label></div>
<div class=ib-w style=margin-bottom:.75rem;margin-top:1.25rem><button id=pb>5. Fetch Content</button><label style=background:var(--ah) title="Batch limit to prevent rate limits or browser freezing"><input type=checkbox id=fbc checked> batch limit: <input type=number id=fbi value=100 min=1 class=ib-i></label></div>
<div id=st>Status: Waiting...</div><label for=jo>6. Final Output</label><textarea id=jo readonly placeholder="Result..."></textarea><div id=sd></div><label for=fi>7. Filename</label><input type=text id=fi placeholder=untitled.txt><button id=db disabled>Download File</button></main>
<script>
const D=document,J=JSON,$=new Proxy({},{get:(_,id)=>D.getElementById(id)}),S=(m,c='var(--t2)')=>{$.st.textContent=m;$.st.style.color=c},GS=(v,u)=>{let n=parseFloat(v);return(isNaN(n)||n<=0)?Infinity:n*({KB:1024,MB:1048576,GB:1073741824}[u]||Infinity)};
const upd=()=>{let u=$.un.value.trim(),r=$.rn.value.trim();if(u&&r)$.fi.placeholder=`${new Date().toISOString().slice(0,10).replace(/-/g,'')}_${$.ps.value}_${u}_${r}_${$.br.value.trim()||'main'}_json.txt`};
[$.ps,$.un,$.rn,$.br].forEach(i=>i.addEventListener('input',upd));
const PU=(f=0)=>{let u=$.ur.value.trim(),e=!$.un.value.trim()&&!$.rn.value.trim(),m;try{let l=new URL(u.startsWith('http')?u:'https://'+u),h=l.hostname,p=l.pathname.split('/').filter(Boolean);if(h.endsWith('.github.io'))m={p:'github',u:h.split('.')[0],r:p[0],b:'main'};if(h=='github.com'||h=='gitlab.com')m={p:h.split('.')[0],u:p[0],r:p[1].replace(/\.git$/,''),b:/tree|blob/.test(p[2])?p[3]:(p[2]=='-'?p[4]||'main':'main')}}catch(e){}if(m&&(f||e)){$.ps.value=m.p;$.un.value=m.u;$.rn.value=m.r;$.br.value=m.b;S('URL Parsed','var(--ok)');upd()}};
let ur_t;$.ur.onpaste=()=>setTimeout(()=>PU(1),10);$.ur.onchange=()=>PU(1);$.ur.oninput=()=>{if(!$.un.value.trim()&&!$.rn.value.trim()){clearTimeout(ur_t);ur_t=setTimeout(PU,300)}};
const GU=()=>{let u=$.un.value.trim(),r=$.rn.value.trim(),b=$.br.value.trim()||'main',g=$.ps.value=='github';if(!u||!r)throw new Error('Missing User/Repo');return g?{b:`https://raw.githubusercontent.com/${u}/${r}/${b}/`,a:`https://api.github.com/repos/${u}/${r}/git/trees/${b}?recursive=1`}:{b:`https://gitlab.com/${u}/${r}/-/raw/${b}/`,a:0}};
const L=(u,d,k)=>{if(!u)return;let l=$[d];l.innerHTML='';S('Fetching...');fetch(u).then(r=>r.json()).then(j=>{if(j.map){l.innerHTML=j.map(x=>`<option value="${x[k]}">`).join('');S('List populated.','var(--ok)')}else S('No data.')}).catch(e=>S(e.message,'var(--err)'))};
$.btn_r.onclick=()=>$.un.value.trim()&&(L($.ps.value=='github'?`https://api.github.com/users/${$.un.value}/repos?per_page=100`:`https://gitlab.com/api/v4/users/${$.un.value}/projects`,'dl_r','name'),$.rn.focus());
$.btn_b.onclick=()=>$.un.value.trim()&&$.rn.value.trim()&&(L($.ps.value=='github'?`https://api.github.com/repos/${$.un.value}/${$.rn.value}/branches?per_page=100`:`https://gitlab.com/api/v4/projects/${$.un.value}%2F${$.rn.value}/repository/branches`,'dl_b','name'),$.br.focus());
const CS=(n,kf=0)=>{let o=+(n.size||0)||+(n._s||0),s=n.type=='file'?n._s||o:(n.children||[]).reduce((a,c)=>a+CS(c,kf),0);if(kf&&n.type=='folder'&&o>0)s=o;let{path:p,content:c,children:h}=n;Object.keys(n).forEach(k=>delete n[k]);n.name=p?p.split('/').pop():'';n.type=c||h||n._s||o?'file':'folder';if(h)n.type='folder';n.size=s.toLocaleString()+" bytes";if(p)n.path=p;if(c)n.content=c;if(h)n.children=h;return s};
const cL=(r,e)=>{if(r.status==403||r.status==429){let t=r.headers.get('x-ratelimit-reset');return t?`${e} (Resets ~${Math.max(0,Math.ceil((t*1e3-Date.now())/6e4))}m)`:e}return r.status==404?'Not Found (404)':`${e} (${r.status})`};
$.cr.onclick=async()=>{if($.ps.value!='github')return S('GitHub only.');S('Checking...');try{let r=await fetch('https://api.github.com/rate_limit');if(!r.ok)throw new Error(cL(r,'API Err'));let c=(await r.json()).resources.core;S(`${c.remaining}/${c.limit} left. Resets in ${Math.max(0,Math.ceil((c.reset*1e3-Date.now())/6e4))}m.`,'var(--ok)')}catch(e){S(e.message,'var(--err)')}};
$.gt.onclick=async()=>{if(!$.un.value.trim()||!$.rn.value.trim())PU(1);S('Generating...');$.gt.disabled=1;$.ji.value='';try{let{a}=GU();if(!a)throw new Error('GitLab Tree API not supported.');let r=await fetch(a);if(!r.ok)throw new Error(cL(r,'Fetch Fail'));let d=await r.json(),t=[];d.tree.forEach(f=>{f.path.split('/').reduce((a,p,i,z)=>{let n=a.find(x=>x.name==p);if(!n){let k=(i==z.length-1&&f.type=='blob')?'file':'folder';n={name:p,type:k,path:z.slice(0,i+1).join('/')};if(k=='file')n._s=f.size||0;else n.children=[];a.push(n)}return n.children||a},t)});t.forEach(n=>CS(n));$.ji.value=J.stringify(t,0,2);S(`Generated ${d.tree.length} items.`,'var(--ok)')}catch(e){S(e.message,'var(--err)')}finally{$.gt.disabled=0}};
const AF=(tr,dp,kf)=>{let W=$.fw.value.split(',').map(x=>x.trim()).filter(Boolean),B=$.fb.value.split(',').map(x=>x.trim()).filter(Boolean),WR=$.fwr.value?new RegExp($.fwr.value):0,BR=$.fbr.value?new RegExp($.fbr.value):0,hr=$.fh.checked,y=$.fn.checked,md=parseInt($.fd.value),mx=GS($.sl.value,$.su.value);md=isNaN(md)?-1:md;let M=(p,a)=>a.some(r=>r.endsWith('/')?p.startsWith(r)||p.includes('/'+r):p==r||p.endsWith('/'+r)),F=[];let sc=n=>{for(let i=n.length;i--;){let x=n[i];if(x.type=='file'){let iw=(W.length&&M(x.path,W))||(WR&&WR.test(x.path)),ib=(B.length&&M(x.path,B))||(BR&&BR.test(x.path)),td=md!=-1&&x.path.split('/').length>md,rj=0,rs="";if(!y){if(ib)rj=1,rs="REDACTED";else if(td)rj=1,rs="Depth limit";else if((W.length||WR)&&!iw)rj=1,rs="Not in Whitelist";if(hr&&iw)rj=0,rs="";let sz=+(x.size||x._s||0).toString().replace(/\D/g,'');if(!rj&&sz>mx&&!(hr&&iw))rj=1,rs=`Size > ${mx}`}if(rj)dp?n.splice(i,1):(x.content=rs=="REDACTED"?rs:`NOTE: Excluded (${rs})`);else F.push({n:x,h:hr&&iw})}else if(x.children){sc(x.children);if(dp&&!kf&&!x.children.length)n.splice(i,1)}}};sc(tr);return F.reverse()};
$.af.onclick=()=>{if(!$.ji.value)return S('Empty.','var(--err)');try{let t=J.parse($.ji.value),k=$.fo.checked;AF(t,1,k);t.forEach(n=>CS(n,k));$.ji.value=J.stringify(t,0,2);S('Pruned.','var(--ok)')}catch(e){S(e.message,'var(--err)')}};
$.pb.onclick=async()=>{S('Starting...');$.pb.disabled=$.db.disabled=1;$.jo.value=$.sd.innerHTML='';try{let{b}=GU(),y=$.fn.checked,t=J.parse($.ji.value),fs=AF(t,0,0);if(!fs.length&&!y)throw new Error('No files.');S(`Found ${fs.length} files...`);let bs=$.fbc.checked?+($.fbi.value)||100:fs.length;if(bs<1)bs=1;for(let i=0;i<fs.length;i+=bs){await Promise.all(fs.slice(i,i+bs).map(async(x,j)=>{let I=i+j,N=x.n,u=b+N.path,lg=m=>S(`[${I+1}/${fs.length}] ${m}: ${N.path}`);try{lg('DL');let r=await fetch(u);if(!r.ok)throw new Error(cL(r,'RL/Auth'));let B=await r.arrayBuffer();N._s=B.byteLength;N.content=(!y&&new Uint8Array(B,0,Math.min(B.byteLength,8e3)).some(v=>!v))?"NOTE: Excluded (Binary)":new TextDecoder().decode(B);lg('Done')}catch(e){N.content=`ERR: ${e.message}`;lg('Fail')}}))}t.forEach(n=>CS(n));S(`Fetched ${fs.length} files.`,'var(--ok)');let o=J.stringify(t,0,2);$.jo.value=o;$.sd.innerHTML=`<strong>Size:</strong> ${o.length.toLocaleString()} chars`;$.db.disabled=0;if(!$.fi.placeholder||$.fi.placeholder=='untitled.txt')upd()}catch(e){S(e.message,'var(--err)')}finally{$.pb.disabled=0}};
$.db.onclick=()=>{if(!$.jo.value)return;let a=D.createElement("a");a.href=URL.createObjectURL(new Blob([$.jo.value]));a.download=$.fi.value.trim()||$.fi.placeholder||'untitled.txt';D.body.append(a);a.click();a.remove()};
['ji','jo'].forEach(i=>{let t=$[i],w=D.createElement('div'),b=D.createElement('div');t.replaceWith(w);w.className='wp';w.append(t,b);b.className='tb';b.innerHTML='<span title=Lock>ðŸ”’</span><span title=Full>â›¶</span><span title=Copy>ðŸ“‹</span>';let[l,f,c]=b.children;l.onclick=()=>l.innerText=t.classList.toggle('au')?'ðŸ”“':'ðŸ”’';f.onclick=e=>{e.stopPropagation();w.classList.toggle('fs')};c.onclick=()=>{navigator.clipboard.writeText(t.value);c.innerText='âœ…';setTimeout(()=>c.innerText='ðŸ“‹',600)}});D.onclick=e=>!e.target.closest('.fs')&&D.querySelector('.fs')?.classList.remove('fs');upd();
</script></body></html>
