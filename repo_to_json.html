<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><title>Repo to JSON/txt</title><style>:root{--b:#121212;--s:#1e1e1e;--t:#e0e0e0;--t2:#a0a0a0;--bd:#444;--a:#3b82f6;--ah:#2563eb;--ok:#28a745;--err:#dc3545;--bt:#4a4a4a}*{box-sizing:border-box}html{font-size:clamp(15px,1.5vw + .5rem,18px)}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;line-height:1.6;color:var(--t);background:var(--b);margin:0;padding:env(safe-area-inset-top,1.5rem) env(safe-area-inset-right,1.5rem) env(safe-area-inset-bottom,1.5rem) env(safe-area-inset-left,1.5rem)}main{background:var(--s);padding:1.5rem;border-radius:.5rem;box-shadow:0 .25rem .75rem #0008;max-width:900px;width:100%;margin:0 auto}h1{text-align:center;color:var(--a);margin:0}label{font-weight:700;margin-top:1.5rem;display:block;color:var(--t2)}.g{display:flex;gap:.5rem;margin-top:.25rem}.g input{flex:1}.g select{flex:0;width:auto}.c{display:flex;align-items:center;gap:.5rem;margin-top:1rem;color:var(--t2)}.c input{width:auto;margin:0}input,select,textarea{width:100%;padding:.75rem;border-radius:.5rem;border:1px solid var(--bd);font-size:.9rem;background:#2a2a2a;color:var(--t)}textarea{min-height:15rem;font-family:monospace;resize:vertical}button{display:block;width:100%;padding:.8rem;margin:1.25rem 0 .75rem;font-size:1rem;font-weight:700;color:#fff;background:var(--a);border:none;border-radius:.5rem;cursor:pointer;transition:background .2s}button:hover:not(:disabled){background:var(--ah)}button:disabled{background:#555;color:#999;cursor:not-allowed}.b2{background:var(--bt);margin-top:.5rem;font-size:.8rem;padding:.6rem}.b2:hover:not(:disabled){background:#5a5a5a}#st{margin:.75rem 0;padding:.75rem;background:#333;border-radius:.5rem;text-align:center;font-weight:700;color:var(--t2);word-wrap:break-word}#sd{margin-top:1rem;text-align:center;font-size:.9rem;color:var(--t2)}@media(max-width:600px){body{padding:.5rem}main{padding:1rem}}
/* Darker Triple Buttons */
.wp{position:relative}.tb{position:absolute;top:0;right:0;z-index:9;display:flex;gap:1px;background:var(--bd);border-radius:0 .5rem 0 .5rem;overflow:hidden;border-left:1px solid var(--bd);border-bottom:1px solid var(--bd)}.tb span{cursor:pointer;padding:.3rem .6rem;background:#050505;color:#aaa;font-size:1rem;line-height:1;user-select:none;transition:.2s}.tb span:hover{background:#333;color:#fff}
.au{field-sizing:content;height:auto!important}.fs{position:fixed;inset:5%;z-index:999;box-shadow:0 0 0 99in #0009;background:var(--s);display:flex;flex-direction:column}.fs textarea{height:100%!important;resize:none}
</style></head><body><main><h1>Universal Git Content Fetcher</h1><p><strong>Instructions:</strong> Configure parameters or paste URL.</p><label>1. Repository Configuration</label><div class=g><select id=ps><option value=github selected>GitHub</option><option value=gitlab>GitLab</option></select><input type=text id=un placeholder="Username"><input type=text id=rn list=dl_r placeholder="Repository"><datalist id=dl_r></datalist><input type=text id=br list=dl_b placeholder="Branch (main)"><datalist id=dl_b></datalist></div><input type=text id=ur placeholder="OR paste full URL here..." style="margin-top:.5rem"><button id=gt>2. Generate JSON File Tree</button><button id=cr class=b2>Check API Rate Limit</button><label for=ji>3. JSON Tree</label><textarea id=ji placeholder="Click 'Generate' or paste JSON..."></textarea><label for=sl>4. Max File Size</label><div class=g><input type=number id=sl value=1 min=1><select id=su><option value=KB>KB</option><option value=MB>MB</option><option value=GB selected>GB</option></select></div><div class=c><input type=checkbox id=fn><label for=fn style=margin:0;font-weight:400>filter nothing (use if buggy)</label></div><button id=pb>5. Fetch Content</button><div id=st>Status: Waiting...</div><label for=jo>6. Final Output</label><textarea id=jo readonly placeholder="Result..."></textarea><div id=sd></div><label for=fi>7. Filename</label><input type=text id=fi placeholder=untitled.txt><button id=db disabled>Download File</button></main><script>const D=document,J=JSON,E=id=>D.getElementById(id),el={p:E('ps'),u:E('un'),r:E('rn'),b:E('br'),ur:E('ur'),ji:E('ji'),jo:E('jo'),gt:E('gt'),cr:E('cr'),pb:E('pb'),st:E('st'),sd:E('sd'),fi:E('fi'),db:E('db')},S=(m,c='var(--t2)')=>{el.st.textContent=m;el.st.style.color=c},GS=(v,u)=>{let n=parseFloat(v);return(isNaN(n)||n<=0)?Infinity:n*(({KB:1024,MB:1048576,GB:1073741824})[u]||Infinity)};
/* URL & API Builders */
const GU=()=>{
  let u=el.ur.value.trim();
  if(u){let m=u.match(/(github|gitlab)\.com\/([^\/]+)\/([^\/]+)(\/tree\/([^\/]+))?/);if(m){el.p.value=m[1];el.u.value=m[2];el.r.value=m[3];el.b.value=m[5]||'main'}}
  let us=el.u.value.trim(),rp=el.r.value.trim(),br=el.b.value.trim()||'main',g=el.p.value=='github';
  if(!us||!rp)throw new Error('Missing User or Repo');
  return g?{base:`https://raw.githubusercontent.com/${us}/${rp}/${br}/`,api:`https://api.github.com/repos/${us}/${rp}/git/trees/${br}?recursive=1`}:{base:`https://gitlab.com/${us}/${rp}/-/raw/${br}/`,api:null}
};
/* Smart Fetch Lists */
const L=(u,d,k)=>{if(!u)return;let l=E(d);l.innerHTML='';S('Fetching list...');fetch(u).then(r=>r.json()).then(j=>{if(Array.isArray(j)){j.forEach(x=>{let o=D.createElement('option');o.value=x[k];l.appendChild(o)});S('List updated.','var(--ok)')}else S('No data.')}).catch(e=>S(e.message,'var(--err)'))};
el.r.onfocus=()=>{if(!el.ur.value.trim()&&el.u.value.trim()&&!el.r.value.trim())L(el.p.value=='github'?`https://api.github.com/users/${el.u.value}/repos?per_page=100`:`https://gitlab.com/api/v4/users/${el.u.value}/projects`,'dl_r','name')};
el.b.onfocus=()=>{if(!el.ur.value.trim()&&el.u.value.trim()&&el.r.value.trim()&&!el.b.value.trim())L(el.p.value=='github'?`https://api.github.com/repos/${el.u.value}/${el.r.value}/branches?per_page=100`:`https://gitlab.com/api/v4/projects/${el.u.value}%2F${el.r.value}/repository/branches`,'dl_b','name')};
el.ur.oninput=()=>{if(el.ur.value.trim())GU();S('URL Parsed','var(--ok)')};
/* Core Logic */
const CS=n=>{let s=n.type=='file'?n._s||(n.size||0): (n.children||[]).reduce((a,c)=>a+CS(c),0);let{path,content,children}=n;delete n.path;delete n.content;delete n.children;delete n.size;delete n._s;n.size=s.toLocaleString()+" bytes";if(path)n.path=path;if(content)n.content=content;if(children)n.children=children;return s};
el.cr.onclick=async()=>{if(el.p.value!='github')return S('GitHub only.');S('Checking...');try{let r=await fetch('https://api.github.com/rate_limit'),d=await r.json(),c=d.resources.core;S(`${c.remaining}/${c.limit} left.`,'var(--ok)')}catch(e){S(e.message,'var(--err)')}};el.gt.onclick=async()=>{S('Generating...');el.gt.disabled=1;el.ji.value='';try{let{api}=GU();if(!api)throw new Error('GitLab Tree API not supported (Paste JSON).');let r=await fetch(api);if(!r.ok)throw new Error(r.status);let d=await r.json(),t=[];d.tree.forEach(f=>{f.path.split('/').reduce((a,p,i,z)=>{let n=a.find(x=>x.name==p);if(!n){let k=(i==z.length-1&&f.type=='blob')?'file':'folder';n={name:p,type:k,path:z.slice(0,i+1).join('/')};if(k=='file')n._s=f.size||0;if(k=='folder')n.children=[];a.push(n)}return n.children||a},t)});t.forEach(CS);el.ji.value=J.stringify(t,null,2);S(`Generated ${d.tree.length} items.`,'var(--ok)')}catch(e){S(e.message,'var(--err)')}finally{el.gt.disabled=0}};el.pb.onclick=async()=>{S('Starting...');el.pb.disabled=el.db.disabled=1;el.jo.value='';el.sd.innerHTML='';try{let{base}=GU(),mx=GS(E('sl').value,E('su').value),by=E('fn').checked,tr=J.parse(el.ji.value),fs=[],sc=n=>{if(Array.isArray(n))n.forEach(x=>{x.type=='file'?fs.push(x):x.children&&sc(x.children)})};sc(tr);if(!fs.length)throw new Error('No files.');S(`Found ${fs.length} files...`);await Promise.all(fs.map(async(f,i)=>{let u=base+f.path,lg=m=>S(`[${i+1}/${fs.length}] ${m}: ${f.path}`),sz=parseInt((f.size||'0').replace(/\D/g,''));try{if(!by){if(sz===0){lg('Size check');let h=await fetch(u,{method:'HEAD'});if(h.ok)sz=parseInt(h.headers.get('content-length')||'0',10)}if(sz>mx){f._s=sz;f.content=`NOTE: Skipped (${sz.toLocaleString()} > ${mx.toLocaleString()}).`;return lg('Skip')}}lg('DL');let r=await fetch(u);if(!r.ok)throw new Error(r.status);let b=await r.arrayBuffer();f._s=b.byteLength;f.content=(by||!new Uint8Array(b,0,Math.min(b.byteLength,8e3)).some(x=>x===0))?new TextDecoder('utf-8').decode(b):"NOTE: Binary.";lg('Done')}catch(e){f.content=`ERR: ${e.message}`;lg('Fail')}}));tr.forEach(CS);S(`Done! ${fs.length} files.`,'var(--ok)');let o=J.stringify(tr,null,2);el.jo.value=o;el.sd.innerHTML=`<strong>Size:</strong> ${o.length.toLocaleString()} chars`;el.db.disabled=0}catch(e){S(e.message,'var(--err)')}finally{el.pb.disabled=0}};el.db.onclick=()=>{if(!el.jo.value)return;let a=D.createElement("a");a.href=URL.createObjectURL(new Blob([el.jo.value],{type:'text/plain;charset=utf-8'}));a.download=el.fi.value.trim()||'untitled.txt';D.body.append(a);a.click();a.remove()};
/* Controls */
['ji','jo'].forEach(i=>{let t=E(i),w=D.createElement('div'),b=D.createElement('div');t.replaceWith(w);w.className='wp';w.append(t,b);b.className='tb';b.innerHTML='<span title=Lock>ðŸ”’</span><span title=Full>â›¶</span><span title=Copy>ðŸ“‹</span>';let[l,f,c]=b.children;l.onclick=()=>l.innerText=t.classList.toggle('au')?'ðŸ”“':'ðŸ”’';f.onclick=e=>{e.stopPropagation();w.classList.toggle('fs')};c.onclick=()=>{navigator.clipboard.writeText(t.value);c.innerText='âœ…';setTimeout(()=>c.innerText='ðŸ“‹',600)}});D.onclick=e=>!e.target.closest('.fs')&&D.querySelector('.fs')?.classList.remove('fs');
</script></body></html>
