#include<stdio.h>
#include<time.h>
unsigned int v[300000];unsigned long long P[300000],B[300000],c=0,q,d,V,C,i,n,k,s,t=0;int main(){double t0=clock(),t1,t2;for(i=3;i<16777216ULL;i+=4){V=i;C=16777216ULL;q=0;d=0;while(q<24){if(V&1){V=V*3+1;C*=3;}else{V>>=1;C>>=1;q++;}if(C<16777216ULL&&(6ULL*C+V<100663296ULL+i)){d=1;break;}}if(!d){v[c]=i;P[c]=C;B[c++]=V;}}t1=clock();for(i=3;i<100663296ULL;i+=4){n=i;while(n>=i){n=n*3+1;n>>=__builtin_ctzll(n);}t++;}for(k=6ULL;k<=596ULL;k++)for(s=0;s<c;s++){i=(k<<24)|v[s];if(i>10000000000ULL)continue;n=k*P[s]+B[s];n>>=__builtin_ctzll(n);while(n>=i){n=n*3+1;n>>=__builtin_ctzll(n);}t++;}t2=clock();printf("Tested %llu numbers\nInit filter %%: %.3f%%\nInit time: %.3fs | Total time: %.3fs\n",t,100.0-(c/167772.16),(t1-t0)/CLOCKS_PER_SEC,(t2-t0)/CLOCKS_PER_SEC);}
