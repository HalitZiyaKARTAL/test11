statcomp() { if [[ "$#" -lt 2 || "$#" -gt 4 ]]; then echo -e "Usage: statcomp <file1> <file2> [ip1_or_alias] [ip2_or_alias]\nDefine aliases with: export myphone=\"127.0.0.1:5555\"" >&2; return 1; fi; local C="\033[31m"; local G="\033[32m"; local R="\033[0m"; _sc_get_stat_data() { local file="$1"; local target="$2"; local P_FMT="%n\n%s\n%b\n%B\n%F\n%d\n%i\n%h\n%a\n%A\n%u\n%U\n%g\n%G\n%C\n%x\n%y\n%z\n%w\n"; if [[ -z "$target" ]]; then stat --printf="$P_FMT" "$file"; else local ip; if [[ "$target" == *.* || "$target" == *:* ]]; then ip="$target"; else ip="${!target:-$target}"; fi; adb -s "$ip" shell "stat -c \$'$P_FMT' '$file'"; fi; }; paste <(_sc_get_stat_data "$1" "$3") <(_sc_get_stat_data "$2" "$4") | awk -F'\t' -v C="$C" -v G="$G" -v R="$R" '{v1[NR]=$1;v2[NR]=$2}END{split("1 6 7",t);for(k in t)N[t[k]]=1;split("9 11 13",t);for(k in t)P[t[k]]=1;split("2 9 16 17 18 19",t);for(k in t)L[t[k]]=1;for(i=1;i<=NR;i++){if(P[i]){m=v1[i]==v2[i]&&v1[i+1]==v2[i+1];s[i]="("v1[i]"/"v1[i+1]")"(m?"ðŸŸ¢":"ðŸ”´")(L[i]?(m?G:C):"")"("v2[i]"/"v2[i+1]")"(L[i]?R:"");i++}else{e=N[i]?"âšª":v1[i]==v2[i]?"ðŸŸ¢":"ðŸ”´";s[i]=v1[i] e "" (L[i]?(e=="ðŸŸ¢"?G:C):"") v2[i] "" (L[i]?R:"")}}printf("  File: %s\n  Size: %s Blocks: %s IO Block: %s %s\nDevice: %s  Inode: %s  Links: %s\nAccess: %s  Uid: %s   Gid: %s\nContext: %s\nAccess: %s\nModify: %s\nChange: %s\n Birth: %s\n",s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9],s[11],s[13],s[15],s[16],s[17],s[18],s[19])}'; };statcomp;
